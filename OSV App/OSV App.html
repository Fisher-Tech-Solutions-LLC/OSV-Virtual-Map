<!DOCTYPE html>
<html>

<head>
    <title>OSV Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div id="map"></div>
    <div id="legend">
        <h3>Legend</h3>
    </div>
    <script>
        var map;

        function initMap() {
            var mapOptions = {

                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map = new google.maps.Map(document.getElementById('map'), {
                center: {
                    lat: 42.107979,
                    lng: -72.098670
                },
                zoom: 15,
                disableDefaultUI: true,
                styles: [{
                        elementType: 'geometry',
                        stylers: [{
                            color: '#ede7c0'
                        }]
                    },
                    {
                        elementType: 'labels.text.stroke',
                        stylers: [{
                            color: '#ede7c0'
                        }]
                    },

                    {
                        elementType: 'labels.text.fill',
                        stylers: [{
                            color: '#d38476'
                        }]
                    }, {
                        featureType: 'poi',
                        elementType: 'labels.text.fill',
                        stylers: [{
                            visibility: 'off'
                        }]
                    }, {
                        featureType: 'road',
                        elementType: 'geometry.stroke',
                        stylers: [{
                            color: '#d38476'
                        }]
                    }
                ]
            });

            infoWindow = new google.maps.InfoWindow;
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    var pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };

                    infoWindow.setPosition(pos);
                    infoWindow.setContent('Location found.');
                    infoWindow.open(map);
                    map.setCenter(pos);
                }, function() {
                    handleLocationError(true, infoWindow, map.getCenter());
                });
            } else {
                // Browser doesn't support Geolocation
                handleLocationError(false, infoWindow, map.getCenter());
            }

            var json = [{
                    "id": "vcbathroom",
                    "title": "vcbathroom",
                    "longitude": "42.108125",
                    "latitude": "-72.098474"
                },
                {
                    "id": "bullardbathroom",
                    "title": "bullardbathroom",
                    "longitude": "42.106444",
                    "latitude": "-72.097345"
                },
                {
                    "id": "countrysidebathroom",
                    "title": "countrysidebathroom",
                    "longitude": "42.105160",
                    "latitude": "-72.095643"
                }
            ];

            var bathrooms = [];
            for (var i = 0; i < 3; i++) {
                var obj = json[i];
                var bathroom = new google.maps.Marker({
                    position: new google.maps.LatLng(obj.longitude, obj.latitude),
                    map: map,
                    icon: 'Images/bathroom icon.png',
                    title: obj.title,
                });
                bathrooms.push(bathroom);
            }

            var potteryString = '<div id="potterycontent">' +
                '<h1 id="firstHeading" class="firstHeading">Pottery Shop</h1>' +
                '<div id="bodyContent">' +
                '<p>The <b>Pottery Shop</b>, is a favorite location for visitors, this exhibit ' +
                'is where many of the villages pottery comes from ' +
                'The pottery shop is originally from Goshen Connecticut where it was built around the year of 1819' +
                'Where the original owner Hervey Brooks produced many pieces of pottery ' +
                'from the years of 1828 to 1864 where he performed his last firing at 85 years old ' +
                '<img src= "Images/pottery shop image.jpg" height = "150px" width = "150px">'
            '</p>'
            '</div>';

            var potterywindow = new google.maps.InfoWindow({
                content: potteryString
            });

            var pot = 'Images/clay pot.png';
            var potteryshop = new google.maps.Marker({
                position: new google.maps.LatLng(
                    42.105229,
                    -72.097357
                ),
                icon: pot,
                map: map,
                title: 'Pottery Shop'
            });

            potteryshop.addListener('click', function() {
                potterywindow.open(map, potteryshop);
            });

            var minergrantString = '<div id="minergrantcontent">' +
                '<h1 id="firstHeading" class ="firstHeading">Miner Grant Store</h1>' +
                '<div id ="bodyContent">' +
                '<p> The <b> Miner Grant Store </b>, is where visitors can find many items to bring home from their trip to the village.' +
                'These items include crafts made in the village as other items that will help you and your family remember your visit long after you leave' +
                '</p>'
            '</div>';

            var minergrantwindow = new google.maps.InfoWindow({
                content: minergrantString
            });

            var money = 'Images/money icon.png';
            var minergrant = new google.maps.Marker({
                position: new google.maps.LatLng(
                    42.107165,
                    -72.097722
                ),
                icon: money,
                map: map,
                title: 'Miner Grant Store'
            });

            minergrant.addListener('click', function() {
                minergrantwindow.open(map, minergrant);
            });

            var barn = 'Images/barn.png';
            var freemanfarm = new google.maps.Marker({
                position: new google.maps.LatLng(
                    42.103809,
                    -72.096426
                ),
                icon: barn,
                map: map,
                title: 'Freeman Farm'
            });

            var centermeetinghouseString = '<div id="centermeetinghousecontent">' +
                '<h1 id="firstHeading" class="firstHeading">Center Meetinghouse</h1>' +
                '<div id="bodyContent">' +
                '<p> The <b> Center Meetinghouse </b>, moved to OSV in 1947, With its steeple pointing skyward, the meetinghouse was the dominant symbol of every New England town—the gathering place for town meetings, elections, and church services. Churchgoers attended lengthy Sunday morning and afternoon services as well as midweek prayer meetings. Many 19th-century New England towns had several different meetinghouses, reflecting the region’s increase in religious diversity after the Revolutionary War. The two largest denominations in most rural towns were Congregationalists and Baptists, both descended from the Puritan Church of the first English settlers. In many rural towns, Methodists, Universalists, Episcopalians, and Friends also had their own houses of worship.' +
                '<img src= "Images/Center Meetinghouse image.jpg" height = "150px" width = "150px">'
            '</p>'
            '</div>';

            var centermeetinghousewindow = new google.maps.InfoWindow({
                content: centermeetinghouseString
            });

            var cross = 'Images/cross.png';
            var centermeetinghouse = new google.maps.Marker({
                position: new google.maps.LatLng(
                    42.106540,
                    -72.099297
                ),
                icon: cross,
                map: map,
                title: 'Center Meetinghouse'
            });

            centermeetinghouse.addListener('click', function() {
                centermeetinghousewindow.open(map, centermeetinghouse);
            });
            /**
                        var schoolhouseString = '<div id = "schoolhousecontent">' +
                            '<h1 id="firstHeading" class="firstHeading">District Schoolhouse</h1>' +
                            '<div id="bodyContent">' +
                            '<p> The <b> District Schoolhouse </b>, first moved to OSV in 1961, Long before the American Revolution, most New Englanders were required to pay taxes to provide tuition-free schools for their children. By 1800, the majority of towns were divided into districts with neighborhood schools. Schools were in session between December and March, when older children did not need to work on the farm. Younger children, too small to help with chores and likely to be underfoot, also attended school between May and August. With up to 50 students of all ages, discipline was often hard to maintain, and punishments were sometimes severe. Teachers, or “school-keepers,” were usually between 17 and 25 years old and had only a district school education themselves.' +
                            '</p>'
                        '</div>';

                        var schoolhousewindow = new google.maps.InfoWindow({
                            content: schooolhouseString
                        });

                        var book = 'Images/book.png';
                        var schoolhouse = new google.maps.Marker({
                            position: new google.maps.LatLng(
                                42.105565,
                                -72.097745
                            ),
                            icon: book,
                            map: map,
                            title: 'Schoolhouse'
                        });

                        schoolhouse.addListener('click', function() {
                            schoolhousewindow.open(map, schoolhouse);
                        });
            **/
            var sheep = 'Images/sheep.png';
            var fennosheeppen = new google.maps.Marker({
                position: new google.maps.LatLng(
                    42.106754,
                    -72.099173
                ),
                icon: sheep,
                map: map,
                title: 'Fenno Sheep Pen'
            });

            var legend = document.getElementById('legend');
            var div = document.createElement('div');
            div.innerHTML = '<img src="Images/bathroom icon.png">';
            legend.appendChild(div);

            map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend);


            google.maps.event.addListener(map, 'zoom_changed', function() {

                var zoom = map.getZoom();
                markerWidth = (zoom / 2) * 2
                markerHeight = (zoom / 2) * 2
                
                for(var i=0;i<3;i++){
                    var bathroom = bathrooms[i];
                    bathroom.setIcon({
                        url: "Images/bathroom icon.png",
                        scaledSize: new google.maps.Size(markerWidth, markerHeight)
                    });
                };
                //set the icon with the new size to the marker
                centermeetinghouse.setIcon({
                    url: cross,
                    scaledSize: new google.maps.Size(markerWidth, markerHeight)
                });
                potteryshop.setIcon({
                    url: pot,
                    scaledSize: new google.maps.Size(markerWidth, markerHeight)
                });
                freemanfarm.setIcon({
                    url: barn,
                    scaledSize: new google.maps.Size(markerWidth, markerHeight)
                });
                minergrant.setIcon({
                    url: money,
                    scaledSize: new google.maps.Size(markerWidth, markerHeight)
                });
                fennosheeppen.setIcon({
                    url: sheep,
                    scaledSize: new google.maps.Size(markerWidth, markerHeight)
                });

            });

            function handleLocationError(browserHasGeolocation, infoWindow, pos) {
                infoWindow.setPosition(pos);
                infoWindow.setContent(browserHasGeolocation ?
                    'Error: The Geolocation service failed.' :
                    'Error: Your browser doesn\'t support geolocation.');
                infoWindow.open(map);
            }
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCt7o7MAPRpmeCI_YQftMWcRh9xezxO5A4 	&callback=initMap" async defer></script>
</body>

</html>
